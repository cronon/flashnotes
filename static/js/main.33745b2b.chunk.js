(this.webpackJsonpflashnotes=this.webpackJsonpflashnotes||[]).push([[0],{17:function(e,t,a){},18:function(e,t,a){},23:function(e,t,a){},24:function(e,t,a){"use strict";a.r(t);var n=a(3),s=a.n(n),c=a(10),i=a.n(c),r=(a(17),a(4)),d=(a(18),a(12)),o=a(2);function l(e){var t=e.note,a=Object(n.useRef)(null);return Object(n.useEffect)((function(){var e=d.a.Flow,n=document.querySelector("#stave"),s=new e.Renderer(n,e.Renderer.Backends.SVG);s.resize(150,200);var c=s.getContext(),i=new e.Stave(10,40,100);i.addClef("treble"),i.setContext(c).draw();var r=new e.StaveNote({clef:"treble",keys:[t.note+"/"+t.octave],duration:"1"});t.accidental&&r.addAccidental(0,new e.Accidental(t.accidental)),r.x_shift=9;var o=new e.Voice({num_beats:4,beat_value:4}).setMode(e.Voice.Mode.SOFT);o.addTickables([r]);(new e.Formatter).joinVoices([o]).format([o],150);return o.draw(c,i),function(){if(a.current){var e=a.current.querySelector("svg");e&&e.remove()}}}),[t]),Object(o.jsx)("div",{className:"stave",id:"stave",ref:a})}var u=a(9),j=a.n(u),h=a(11),b=a(0),m=a(1),f=a(7),v=a.n(f),y={C:1,"C#":2,Db:2,D:3,"D#":4,Eb:4,E:5,F:6,"F#":7,Gb:7,G:8,"G#":9,Ab:9,A:10,"A#":11,Bb:11,B:12};var k=function(){function e(t,a,n,s,c){Object(b.a)(this,e),this.midi=t,this.str=a,this.accidental=n,this.note=s,this.octave=c}return Object(m.a)(e,[{key:"eq",value:function(e){return this.midi===e.midi}},{key:"toString",value:function(){return this.str}}],[{key:"fromNumber",value:function(t){var a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t%12],n=Math.floor(t/12)-1;return new e(t,a+n,a[1]||null,a,n)}},{key:"fromString",value:function(t){var a=3===t.length?t[0]+t[1]:t[0],n=y[a]-1,s=+t[t.length-1];return new e(n+12*(s+1),t,"b"===t[1]||"#"===t[1]?t[1]:null,a,s)}}]),e}(),O=[];function p(e,t){var a=document.querySelector('audio[data-note="'.concat(e.toString(),'"]'));if(!a)throw new Error("Cannot find <audio> for note "+e.toString());t(a)}function x(e){p(e,(function(t){O.find((function(t){return t.eq(e)}))||(O.push(e),t.currentTime=0,t.play())}))}function N(e){(e=e||v.a.last(O))&&p(e,(function(t){t.currentTime=0,t.pause(),v.a.remove(O,(function(t){return t.eq(e)}))}))}function w(e){return C.apply(this,arguments)}function C(){return(C=Object(h.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(t),e.abrupt("return",new Promise((function(e){setTimeout((function(){N(t),e()}),500)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(23);function S(e){var t={65:"C4",87:"C#4",83:"D4",69:"D#4",68:"E4",70:"F4",84:"F#4",71:"G4",89:"G#4",72:"A4",85:"A#4",74:"B4",75:"C5",79:"C#5",76:"D5",80:"D#5",186:"E5"}[e];if(t)return k.fromString(t);throw new Error("Undefined key pressed "+e)}function g(e){var t=e.onKey;Object(n.useEffect)((function(){function e(e){var t=document.querySelector('.key[data-key="'.concat(e.keyCode,'"]'));t&&(t.classList.add("playing"),x(S(e.keyCode)))}function a(e){var a=document.querySelector('.key[data-key="'.concat(e.keyCode,'"]'));if(a){a.classList.remove("playing");var n=S(e.keyCode);N(n),t(n)}}return window.addEventListener("keydown",e),window.addEventListener("keyup",a),function(){window.removeEventListener("keydown",e),window.removeEventListener("keyup",a)}}),[t]);var a=Object(n.useCallback)((function(e){var a=e.target,n=a.dataset.note;if(n){var s=k.fromString(n);x(s),a.classList.add("playing"),s,w(s).then((function(){a.classList.remove("playing"),t(s)}))}}),[t]);return Object(o.jsxs)("section",{id:"main",children:[Object(o.jsx)("div",{className:"nowplaying"}),Object(o.jsxs)("div",{className:"keys",onMouseDown:a,children:[Object(o.jsx)("div",{"data-key":"65",className:"key","data-note":"C4",children:Object(o.jsx)("span",{className:"hints",children:"A"})}),Object(o.jsx)("div",{"data-key":"87",className:"key sharp","data-note":"C#4",children:Object(o.jsx)("span",{className:"hints",children:"W"})}),Object(o.jsx)("div",{"data-key":"83",className:"key","data-note":"D4",children:Object(o.jsx)("span",{className:"hints",children:"S"})}),Object(o.jsx)("div",{"data-key":"69",className:"key sharp","data-note":"D#4",children:Object(o.jsx)("span",{className:"hints",children:"E"})}),Object(o.jsx)("div",{"data-key":"68",className:"key","data-note":"E4",children:Object(o.jsx)("span",{className:"hints",children:"D"})}),Object(o.jsx)("div",{"data-key":"70",className:"key","data-note":"F4",children:Object(o.jsx)("span",{className:"hints",children:"F"})}),Object(o.jsx)("div",{"data-key":"84",className:"key sharp","data-note":"F#4",children:Object(o.jsx)("span",{className:"hints",children:"T"})}),Object(o.jsx)("div",{"data-key":"71",className:"key","data-note":"G4",children:Object(o.jsx)("span",{className:"hints",children:"G"})}),Object(o.jsx)("div",{"data-key":"89",className:"key sharp","data-note":"G#4",children:Object(o.jsx)("span",{className:"hints",children:"Y"})}),Object(o.jsx)("div",{"data-key":"72",className:"key","data-note":"A4",children:Object(o.jsx)("span",{className:"hints",children:"H"})}),Object(o.jsx)("div",{"data-key":"85",className:"key sharp","data-note":"A#4",children:Object(o.jsx)("span",{className:"hints",children:"U"})}),Object(o.jsx)("div",{"data-key":"74",className:"key","data-note":"B4",children:Object(o.jsx)("span",{className:"hints",children:"J"})}),Object(o.jsx)("div",{"data-key":"75",className:"key","data-note":"C5",children:Object(o.jsx)("span",{className:"hints",children:"K"})}),Object(o.jsx)("div",{"data-key":"79",className:"key sharp","data-note":"C#5",children:Object(o.jsx)("span",{className:"hints",children:"O"})}),Object(o.jsx)("div",{"data-key":"76",className:"key","data-note":"D5",children:Object(o.jsx)("span",{className:"hints",children:"L"})}),Object(o.jsx)("div",{"data-key":"80",className:"key sharp","data-note":"D#5",children:Object(o.jsx)("span",{className:"hints",children:"P"})}),Object(o.jsx)("div",{"data-key":"186",className:"key","data-note":"E5",children:Object(o.jsx)("span",{className:"hints",children:";"})})]})]})}var E=function(){var e=Object(n.useState)(k.fromString("C4")),t=Object(r.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)("?"),i=Object(r.a)(c,2),d=i[0],u=i[1];Object(n.useEffect)((function(){w(a)}),[a]);var j=Object(n.useCallback)((function(e){e.eq(a)&&(u(a.toString()),setTimeout((function(){u("?");var e=k.fromNumber(v.a.random(60,72));s(e)}),500))}),[a]);return Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)(l,{note:a}),Object(o.jsx)("h1",{children:d}),Object(o.jsx)(g,{onKey:j})]})};i.a.render(Object(o.jsx)(s.a.StrictMode,{children:Object(o.jsx)(E,{})}),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.33745b2b.chunk.js.map