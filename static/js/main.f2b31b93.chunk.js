(this.webpackJsonpflashnotes=this.webpackJsonpflashnotes||[]).push([[0],{17:function(e,t,a){},18:function(e,t,a){},23:function(e,t,a){},24:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a.n(n),c=a(10),s=a.n(c),o=(a(17),a(4)),i=(a(18),a(12)),d=a(2);function u(e){var t=e.note,a=Object(n.useRef)(null);return Object(n.useEffect)((function(){var e=i.a.Flow,n=document.querySelector("#stave"),r=new e.Renderer(n,e.Renderer.Backends.SVG);r.resize(150,200);var c=r.getContext(),s=new e.Stave(10,40,100);s.addClef("treble"),s.setContext(c).draw();var o=new e.StaveNote({clef:"treble",keys:[t.note+"/"+t.octave],duration:"1"});t.accidental&&o.addAccidental(0,new e.Accidental(t.accidental)),o.x_shift=9;var d=new e.Voice({num_beats:4,beat_value:4}).setMode(e.Voice.Mode.SOFT);d.addTickables([o]);(new e.Formatter).joinVoices([d]).format([d],150);return d.draw(c,s),function(){if(a.current){var e=a.current.querySelector("svg");e&&e.remove()}}}),[t]),Object(d.jsx)("div",{className:"stave",id:"stave",ref:a})}var f=a(9),l=a.n(f),v=a(11),y=a(0),j=a(1),m=a(5),k=a.n(m),b={C:1,"C#":2,Db:2,D:3,"D#":4,Eb:4,E:5,F:6,"F#":7,Gb:7,G:8,"G#":9,Ab:9,A:10,"A#":11,Bb:11,B:12},O=k.a.range(60,73).map((function(e){return{note:e,times:0}}));var h=function(){function e(t,a,n,r,c){Object(y.a)(this,e),this.midi=t,this.str=a,this.accidental=n,this.note=r,this.octave=c}return Object(j.a)(e,[{key:"eq",value:function(e){return this.midi===e.midi}},{key:"toString",value:function(){return this.str}}],[{key:"fromNumber",value:function(t){var a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t%12],n=Math.floor(t/12)-1;return new e(t,a+n,a[1]||null,a,n)}},{key:"fromString",value:function(t){var a=3===t.length?t[0]+t[1]:t[0],n=b[a]-1,r=+t[t.length-1];return new e(n+12*(r+1),t,"b"===t[1]||"#"===t[1]?t[1]:null,a,r)}}]),e}(),p=[];function w(e,t){var a=document.querySelector('audio[data-note="'.concat(e.toString(),'"]'));if(!a)throw new Error("Cannot find <audio> for note "+e.toString());t(a)}function x(e){w(e,(function(t){p.find((function(t){return t.eq(e)}))||(p.push(e),t.currentTime=0,t.play())}))}function C(e){(e=e||k.a.last(p))&&w(e,(function(t){t.currentTime=0,t.pause(),k.a.remove(p,(function(t){return t.eq(e)}))}))}function N(e){return S.apply(this,arguments)}function S(){return(S=Object(v.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(t),e.abrupt("return",new Promise((function(e){setTimeout((function(){C(t),e()}),500)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(23);function g(e){var t={65:"C4",87:"C#4",83:"D4",69:"D#4",68:"E4",70:"F4",84:"F#4",71:"G4",89:"G#4",72:"A4",85:"A#4",74:"B4",75:"C5",79:"C#5",76:"D5",80:"D#5",186:"E5"}[e];if(t)return h.fromString(t);throw new Error("Undefined key pressed "+e)}function E(e){var t=e.onKey;Object(n.useEffect)((function(){function e(e){var t=document.querySelector('.key[data-key="'.concat(e.keyCode,'"]'));t&&(t.classList.add("playing"),x(g(e.keyCode)))}function a(e){var a=document.querySelector('.key[data-key="'.concat(e.keyCode,'"]'));if(a){a.classList.remove("playing");var n=g(e.keyCode);C(n),t(n)}}return window.addEventListener("keydown",e),window.addEventListener("keyup",a),function(){window.removeEventListener("keydown",e),window.removeEventListener("keyup",a)}}),[t]);var a=Object(n.useCallback)((function(e){var a=e.target,n=a.dataset.note;if(n){var r=h.fromString(n);x(r),a.classList.add("playing"),r,N(r).then((function(){a.classList.remove("playing"),t(r)}))}}),[t]);return Object(d.jsx)("section",{id:"main",children:Object(d.jsxs)("div",{className:"keys",onMouseDown:a,children:[Object(d.jsx)("div",{"data-key":"65",className:"key","data-note":"C4"}),Object(d.jsx)("div",{"data-key":"87",className:"key sharp","data-note":"C#4"}),Object(d.jsx)("div",{"data-key":"83",className:"key","data-note":"D4"}),Object(d.jsx)("div",{"data-key":"69",className:"key sharp","data-note":"D#4"}),Object(d.jsx)("div",{"data-key":"68",className:"key","data-note":"E4"}),Object(d.jsx)("div",{"data-key":"70",className:"key","data-note":"F4"}),Object(d.jsx)("div",{"data-key":"84",className:"key sharp","data-note":"F#4"}),Object(d.jsx)("div",{"data-key":"71",className:"key","data-note":"G4"}),Object(d.jsx)("div",{"data-key":"89",className:"key sharp","data-note":"G#4"}),Object(d.jsx)("div",{"data-key":"72",className:"key","data-note":"A4"}),Object(d.jsx)("div",{"data-key":"85",className:"key sharp","data-note":"A#4"}),Object(d.jsx)("div",{"data-key":"74",className:"key","data-note":"B4"}),Object(d.jsx)("div",{"data-key":"75",className:"key","data-note":"C5"}),Object(d.jsx)("div",{"data-key":"79",className:"key sharp","data-note":"C#5"}),Object(d.jsx)("div",{"data-key":"76",className:"key","data-note":"D5"}),Object(d.jsx)("div",{"data-key":"80",className:"key sharp","data-note":"D#5"}),Object(d.jsx)("div",{"data-key":"186",className:"key","data-note":"E5"})]})})}var D=function(){var e=Object(n.useState)(h.fromString("C4")),t=Object(o.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)("?"),s=Object(o.a)(c,2),i=s[0],f=s[1];Object(n.useEffect)((function(){N(a)}),[a]);var l=Object(n.useCallback)((function(e){e.eq(a)&&(f(a.toString()),setTimeout((function(){f("?");var e=function(){k.a.random(60,72);var e=O.reduce((function(e,t){return t.times<e?t.times:e}),O[0].times),t=O.filter((function(t){return e+2>t.times})).map((function(e){return e.note})).concat(60),a=k.a.sample(t);return O.find((function(e){return e.note===a})).times+=1,h.fromNumber(a)}();r(e)}),500))}),[a]);return Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)(u,{note:a}),Object(d.jsx)("h1",{children:i}),Object(d.jsx)(E,{onKey:l})]})};s.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(D,{})}),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.f2b31b93.chunk.js.map